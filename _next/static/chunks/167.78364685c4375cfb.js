"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[167],{5471:function(e,t,n){n.d(t,{Z:function(){return MDX_Card}});var r=n(7294),a=n(3235),o=(0,n(2854).zo)("div",{paddingBottom:"$gr4",zIndex:"1","@md":{paddingBottom:"$gr3"},"@xs":{paddingBottom:"$gr2"}});n(6803),n(2794),n(3981);var i=n(633),l=n(5893),MDX_Card=function(e){var t=e.iiifContent,n=e.label,c=(0,r.useState)(),s=c[0],u=c[1];return((0,r.useEffect)(function(){if(t){var e=i.find(function(e){return e.id===t});e&&u({id:t,type:"Manifest",label:n||e.label,thumbnail:e.thumbnail,homepage:[{id:"/works/".concat(e.slug),label:e.label,type:"Text"}]})}},[t,n,i]),s)?(0,l.jsx)(o,{"data-testid":"mdx-card",children:(0,l.jsx)(a.Z,{resource:s})}):null}},6858:function(e,t,n){n.r(t),n.d(t,{default:function(){return Map_Map}});var r=n(7812),a=n(9499);n(9369),n(9429),n(3656);var o=n(3245),i=n(5715),l=n(9635),c=n(2013),s=n(5996),u=n(577),p=n(2604),d=n(2469),h=n(7294),f=n(5471),g=(0,n(2854).zo)("div",{height:"100vh",width:"100%",position:"fixed",zIndex:"0",top:"0",".map-container":{height:"100%",width:"100%",backgroundColor:"var(--gray-1)",figure:{width:"100%",margin:"0",padding:"0"}},".leafletPopupContentWrapper":{backgroundColor:"var(--gray-2)"},".leafletPopupContent":{margin:0},".leafletPopupTip":{backgroundColor:"var(--accent-a10)"},".canopyMapPopup":{width:"240px",img:{maxHeight:"100% !important"}},figure:{img:{width:"100%",maxHeight:"200px"},video:{display:"none"}}}),m=n(7191);n(5732);var b=n(5243),v=n.n(b),y=n(8806);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach(function(t){(0,a.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var createClusterCustomIcon=function(e){var t=e.getChildCount();return v().divIcon({className:"canopy-map-cluster-group-icon",html:'<button data-accent-color="" data-radius="full" style="box-shadow: var(--shadow-3); cursor: pointer; outline-style: none" class="rt-reset rt-BaseButton rt-r-size-3 rt-variant-solid rt-IconButton"><span class="rt-Text rt-r-size-4 rt-r-weight-bold">'.concat(t,"</span></button>"),iconSize:v().point(40,40,!0),iconAnchor:[20,40],popupAnchor:[0,-40]})},x=(0,y.Au)(function(e,t){(0,m.Z)(e);var n=v().markerClusterGroup({iconCreateFunction:createClusterCustomIcon,polygonOptions:{weight:2,opacity:1}});return{instance:n,context:_objectSpread(_objectSpread({},t),{},{layerContainer:n})}}),j=n(7459),w=n(5049),getLabel=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";if(!e)return["Untitled"];if("string"==typeof e)return[e];if(!e[t]){var n=Object.getOwnPropertyNames(e);if(n.length>0)return e[n[0]]}return e[t]},O=n(5893);function Map_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Map_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Map_ownKeys(Object(n),!0).forEach(function(t){(0,a.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Map_ownKeys(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var S={defaultBounds:[[51.505,-.09]],tileLayers:[{name:"OpenStreetMap",url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}]},parseNavDate=function(e){if(!e)return null;if("string"==typeof e){var t=new Date(e);return isNaN(t.getTime())?null:t}if(Array.isArray(e)&&e.length>0){var n=new Date(e[0]);return isNaN(n.getTime())?null:n}if("object"==typeof e&&e.value){var r=new Date(e.value);return isNaN(r.getTime())?null:r}return null},Map_Map=function(e){var t=e.manifests,n=(0,h.useState)(S.tileLayers[0]),a=n[0],m=n[1],b=S.defaultBounds,y=(0,h.useRef)(null),D=(0,h.useState)(b),C=D[0],z=D[1],M=(0,h.useState)([0,0]),k=M[0],P=M[1],_=(0,h.useMemo)(function(){var e=t.map(function(e){return Map_objectSpread(Map_objectSpread({},e),{},{parsedDate:parseNavDate(e.navDate)})}).filter(function(e){return null!==e.parsedDate});if(0===e.length)return{minYear:new Date().getFullYear(),maxYear:new Date().getFullYear(),manifestsWithDates:t};var n=e.map(function(e){return e.parsedDate.getFullYear()});return{minYear:Math.min.apply(Math,(0,r.Z)(n)),maxYear:Math.max.apply(Math,(0,r.Z)(n)),manifestsWithDates:e}},[t]),B=_.minYear,N=_.maxYear,I=_.manifestsWithDates;(0,h.useEffect)(function(){P([B,N])},[B,N]);var T=(0,h.useMemo)(function(){return t.filter(function(e){var t=parseNavDate(e.navDate);if(!t)return!0;var n=t.getFullYear();return n>=k[0]&&n<=k[1]})},[t,k]);return(0,h.useEffect)(function(){var e=(0,j.z)(T);e.length>0&&z(e)},[T]),(0,h.useEffect)(function(){y.current&&C&&y.current.fitBounds(C)},[y,C]),(0,O.jsxs)(g,{css:{top:w.J9,height:"calc(100vh - ".concat(w.J9,"px)")},children:[(0,O.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n    .leaflet-popup {\n      width: 240px;\n    }\n    \n    .leaflet-popup-content-wrapper {\n      background-color: var(--gray-2);\n      overflow: hidden;\n      border: none;\n    }\n\n    .leaflet-popup-content {\n      margin: 0;\n\n      img {\n        max-height: 100% !important;\n      }\n    }\n\n    .leaflet-popup-tip {\n      background-color: var(--accent-a10);\n      opacity: 0.2;\n    }\n\n    .leaflet-control {\n      background-color: var(--accent-10);\n    }\n\n    .leaflet-bar a {\n      background-color: var(--accent-10);\n      color: var(--gray-12);\n      fill: var(--gray-12);\n    }\n\n    .leaflet-control-layers {\n      display: none;\n    }\n\n    html {\n      overflow: hidden;\n    }\n\n    html.dark .leaflet-layer { \n      filter: invert(100%) hue-rotate(180deg) brightness(90%) contrast(90%);\n    }\n  "}}),(0,O.jsxs)(i.h,{className:"map-container",bounds:C,scrollWheelZoom:!0,zoomControl:!1,ref:y,children:[(0,O.jsx)(o.Box,{style:{position:"absolute",zIndex:1e3,top:0,right:0,padding:"var(--space-5)"},children:(0,O.jsxs)(o.Flex,{gap:"4",children:[S.tileLayers.length>1&&(0,O.jsxs)(o.Select.Root,{defaultValue:a.name,onValueChange:function(e){var t=S.tileLayers.find(function(t){return t.name===e});t&&m(t)},size:"3",children:[(0,O.jsx)(o.Select.Trigger,{style:{boxShadow:"var(--shadow-3)",background:"var(--gray-1)"}}),(0,O.jsx)(o.Select.Content,{children:(0,O.jsxs)(o.Select.Group,{children:[(0,O.jsx)(o.Select.Label,{children:"Layers"}),S.tileLayers.map(function(e,t){return(0,O.jsx)(o.Select.Item,{value:e.name,children:e.name},t)})]})})]}),(0,O.jsxs)(o.Flex,{direction:"column",gap:"2",children:[(0,O.jsx)(o.IconButton,{"aria-label":"zoom in",size:"3",onClick:function(){var e;return null===(e=y.current)||void 0===e?void 0:e.zoomIn()},style:{boxShadow:"var(--shadow-3)",cursor:"pointer"},children:(0,O.jsx)(d.pOD,{})}),(0,O.jsx)(o.IconButton,{"aria-label":"zoom out",size:"3",onClick:function(){var e;return null===(e=y.current)||void 0===e?void 0:e.zoomOut()},style:{boxShadow:"var(--shadow-3)",cursor:"pointer"},children:(0,O.jsx)(d.V_R,{})})]})]})}),I.length>0&&B!==N&&(0,O.jsx)(o.Box,{style:{position:"absolute",zIndex:1e3,bottom:0,left:0,right:0,padding:"var(--space-5)",background:"var(--gray-1)",borderTop:"1px solid var(--gray-6)",boxShadow:"var(--shadow-3)"},children:(0,O.jsxs)(o.Flex,{direction:"column",gap:"3",children:[(0,O.jsxs)(o.Flex,{justify:"between",align:"center",children:[(0,O.jsxs)(o.Text,{size:"2",weight:"medium",children:["Date Range: ",k[0]," - ",k[1]]}),(0,O.jsxs)(o.Text,{size:"1",color:"gray",children:[T.length," of ",t.length," items"]})]}),(0,O.jsx)(o.Box,{className:"custom-slider",children:(0,O.jsx)(o.Slider,{value:k,onValueChange:function(e){P([e[0],e[1]])},min:B,max:N,step:1,minStepsBetweenThumbs:1,style:{width:"100%"}})}),(0,O.jsxs)(o.Flex,{justify:"between",children:[(0,O.jsx)(o.Text,{size:"1",color:"gray",children:B}),(0,O.jsx)(o.Text,{size:"1",color:"gray",children:N})]})]})}),(0,O.jsx)(l.et,{position:"bottomright",children:(0,O.jsx)(l.et.BaseLayer,{name:a.name,checked:!0,children:(0,O.jsx)(c.I,{url:a.url,attribution:a.attribution})})}),(0,O.jsx)(x,{children:(0,O.jsx)(s.$,{children:T.map(function(e){return e.features.map(function(t,n){var r,a,o,i;return(0,O.jsx)(u.J,{position:[t.geometry.coordinates[1],t.geometry.coordinates[0]],icon:(o=e.thumbnail[0].id,i=getLabel(null==t?void 0:null===(r=t.properties)||void 0===r?void 0:r.label),v().divIcon({className:"canopy-map-marker-icon",html:'<button data-accent-color="" data-radius="full" style="box-shadow: var(--shadow-3); cursor: pointer; outline-style: none;" class="rt-reset rt-BaseButton rt-r-size-2 rt-variant-solid rt-IconButton"><img src="'.concat(o,'" alt="').concat(i,'" style="height: 100%; width: 100%; border-radius: 50%; object-fit: cover;" /></button>').toString(),iconSize:v().point(32,32,!0),iconAnchor:[16,32],popupAnchor:[0,-32]})),children:(0,O.jsx)(p.G,{className:"canopy-map-popup",children:(0,O.jsx)(f.Z,{iiifContent:e.id,label:getLabel(null==t?void 0:null===(a=t.properties)||void 0===a?void 0:a.label)})})},"".concat(e.id,"-").concat(n,"-").concat(k[0],"-").concat(k[1]))})})})},"cluster-".concat(T.length,"-").concat(k[0],"-").concat(k[1]))]})]})}}}]);